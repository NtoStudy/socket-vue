<script setup>
import { ref } from 'vue'
import MomentsHeader from '@/components/moments/MomentsHeader.vue'
import MomentItem from '@/components/moments/MomentItem.vue'

// æ¨¡æ‹Ÿæœ‹å‹åœˆæ•°æ®
const momentsList = ref([
  {
    id: 1,
    avatar: 'https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png',
    username: 'å—èˆªç§‘é™¢å¸®å¸®å›¢ äººæ»¡åŠ 2å·ramelsa',
    content: 'ã€æŠ•ç¨¿ã€‘æƒ³é—®ä¸€ä¸‹å­¦æ ¡å“ªé‡Œå¯ä»¥ç°é‡‘æ¢ä½ç½®é’±',
    time: '3å°æ—¶å‰',
    likes: ['å°ç¾½', 'å°ç¾½'],
    comments: [
      {
        username: 'å—èˆªç§‘é™¢å¸®å¸®å›¢ äººæ»¡åŠ 2å·ramelsa',
        content: 'ç»™å…„å¼Ÿä¹°åŒ…ç“œå­å»',
      },
      {
        username: 'å—èˆªç§‘é™¢å¸®å¸®å›¢ äººæ»¡åŠ 2å·ramelsa',
        content: 'å“ˆå“ˆï¼Œæœ¬äººæ¥äº†ï¼Œæ²¡æƒ³åˆ°åªæ˜¯éšæ‰‹ä¸€æ¡å°±è¢«å‘åˆ°è¡¨ç™½å¢™äº†',
      },
    ],
    isLiked: false,
    showActions: false,
  },
  {
    id: 2,
    avatar: 'https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png',
    username: 'å—èˆªç§‘é™¢å¸®å¸®å›¢ äººæ»¡åŠ 2å·ramelsa',
    content:
      'ã€æŠ•ç¨¿ã€‘ç‘¶ç‘¶ é—®ä¸€ä¸‹æœ‰æ²¡æœ‰äººæ”¶isooæ¾³é—¨åœºçš„ç¥¨ 22å·çš„ æœ‹å‹å¸®å¿™å¤šæŠ¢äº†å››å¼  998å’Œ900çš„å„å¤šä¸¤å¼ ğŸ’° æœ‰çš„åŠ æˆ‘ä¸€ä¸‹ï½åˆ°æ—¶å€™å¯ä»¥ä¸€èµ·å»ğŸ§©',
    time: '2åˆ†é’Ÿå‰',
    images: ['https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg'],
    likes: [],
    comments: [],
    isLiked: false,
    showActions: false,
  },
  {
    id: 3,
    avatar: 'https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png',
    username: 'å—èˆªç§‘é™¢å¸®å¸®å›¢ äººæ»¡åŠ 2å·ramelsa',
    content: 'ã€æŠ•ç¨¿ã€‘æ‰¾ä¸ªæ˜å¤©æ—©å…«ä»£è¯¾å¥³ç”Ÿ',
    time: 'åˆšåˆš',
    images: ['https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg'],
    likes: [],
    comments: [],
    isLiked: false,
    showActions: false,
  },
])

// æ›´æ–°æœ‹å‹åœˆé¡¹ç›®
const updateMomentItem = (updatedItem) => {
  const index = momentsList.value.findIndex((item) => item.id === updatedItem.id)
  if (index !== -1) {
    // å…ˆå…³é—­æ‰€æœ‰å…¶ä»–é¡¹çš„æ“ä½œèœå•
    momentsList.value.forEach((moment) => {
      if (moment.id !== updatedItem.id) {
        moment.showActions = false
      }
    })
    // æ›´æ–°å½“å‰é¡¹
    momentsList.value[index] = updatedItem
  }
}
</script>

<template>
  <div class="moments-container">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <moments-header />

    <!-- æœ‹å‹åœˆå†…å®¹åˆ—è¡¨ -->
    <div class="moments-content">
      <div class="moments-wrapper">
        <moment-item v-for="item in momentsList" :key="item.id" :item="item" @update:item="updateMomentItem" />
      </div>
    </div>
  </div>
</template>

<style lang="scss" scoped>
.moments-container {
  display: flex;
  flex-direction: column;
  height: 100vh;
  background-color: #f7f7f7;

  .moments-content {
    flex: 1;
    overflow-y: auto;
    padding: 10px 0;
    display: flex;
    justify-content: center;

    .moments-wrapper {
      width: 100%;
      max-width: 600px;
    }
  }
}

// ç§»åŠ¨ç«¯é€‚é…
@media (max-width: 768px) {
  .moments-container {
    .moments-content {
      .moments-wrapper {
        width: 100%;
      }
    }
  }
}
</style>
